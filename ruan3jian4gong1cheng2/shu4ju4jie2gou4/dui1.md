## 堆

### 堆的应用

##### 优先级队列

维护一个大根堆，入队就是大根堆插入的操作，出队就是移除堆顶

##### 合并有序小文件

有100个有序的小文件需要合并成一个大文件

每个小文件取一位构造一个小根堆，然后移出堆顶，放入新文件

然后从移出的元素对应的文件再取一位加入小根堆

##### 高性能定时器

将定时执行的任务按照时间构造一个小根堆，这样任何任务都不会先于堆顶任务执行

堆顶元素下次执行的时间前，不需要去遍历列表查询是否有定时任务需要执行

### 求前k位

维护一个长度为k的小顶堆，遍历数组，如果数据比堆顶大，就移除堆顶，把这个元素加进去

### 求中位数

n个数据，分两份，用小的一半构造一个大根堆，用大的一半构造小根堆

如果n是偶数，两个堆的堆顶就是中位数

如果n是奇数，可以安排一个堆里是n/2+1个数，这个堆顶就是中位数

如果是动态的情况，比如一个小根堆n个，大根堆n+1个

这个时候来了一个小数字，需要放到大根堆里，但是这样两堆数据数量就不一样了

这个时候可以先把数字放到大根堆里，然后得到堆化后的结果后，将大根堆的堆顶移除，并在小根堆插入

这样两堆数据数据数量就平衡了

### 求大于90%的数

这个思路和求中位数一样，维护两个堆，一个保存10%的数据，一个保存90%的数据

### 求10亿关键词中Top10的关键词

首先通过散列表统计关键词的次数，然后用一个长度为10的小根堆统计Top10

这里有一个内存可能不够的问题，这个问题可以通过哈希函数进行分片，把10亿关键词分别放到10个文件里去，这样每个文件就只有1亿关键词

对每个文件求Top10，然后使用上面合并小文件的方式求出总的Top10